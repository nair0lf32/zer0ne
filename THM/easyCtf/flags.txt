//ok for a ctf called easyctf Im tryin to do it asap so I wont be too verbose here

//robots.txt is written by 'mike' 

//this comes alot: Easy Software Products (http://www.cups.org)

Disallow: /
Disallow: /openemr-5_0_1_3

//fuzzing show a simple page with 301 code...we visited we see a simple page made with cms made simple (CMSMS)

This site is powered by CMS Made Simple version 2.2.8
//okay then

To get to the Administration Console you have to login as the administrator (with the username/password you mentioned during the installation process) on your site at http://yourwebsite.com/cmsmspath/admin. If this is your site click here to login.

//lets google
//actually...found alot of cve that matches this version...but time-based sqli? really?
CVE-2019-9053

//there is an exploit from exploitdb provided...a python script we are gonna use

//that stuff took me too long man...took me hours to fix the script and make it work with python3...I had to

- change shebang line on top to 'python3' instead of 'python'
- add parenthesis to the print statements
- fix an error with md5 (added encode UTF-8 before the hexdigest) in crack_password function
- made sure to point -u argument to the simple cms path...like http://ip_address/simple
- and the most frustrating the TIME variable! due to my stupid slow internet I had to increase the variable to 20
to have results and it obviously took me waaaay longer (I hate my ISP so much)

[+] Salt for password found: 1dac0d92e9fa6bb2
[+] Username found: mitch
[+] Email found: admin@admin.com
[+] Password found: 0c01f4468bd75d7a84c7eb73846e8d96
[+] Password cracked: secret

//we ssh as mitch (remember the port is unusual -p 2222)

//and we get into business! FLAG 1
$ cat user.txt
G00d j0b, keep up!

//now time to privEsc..the basics first
$ sudo -l
User mitch may run the following commands on Machine:
(root) NOPASSWD: /usr/bin/vim

//OH NO NOT VIM...hey but wait..we can run commands in vim...
sudo vim

//then in vim we go:

:!/bin/bash


root@Machine:~# id
uid=0(root) gid=0(root) groups=0(root)


//haha took a second...fastest privEsc in the west

root@Machine:/root# cat root.txt
W3ll d0n3. You made it!

//yeah ok right...only the python script was painful...its indeed an easy ctf

//glhf!


